<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="UTF-8">
	<title>Web messaging demo</title>
	<link rel="stylesheet" href="http://devfiles.myopera.com/articles/8222/webmessaging.css" media="screen">
	<style>
		iframe{width:80%;}
	</style>
</head>
<body>

	<h1>Web Messaging Demo: Sending a message to a document within an <code>iframe</code></h1>

	<form>
	<p><input type="text" name="message" id="message" value="" placeholder="Enter a message to send."><br><button>Send message</button></p>
	</form>

	<iframe src="http://devfiles.myopera.com/articles/8222/crossdocmsg.iframe_document.html"></iframe>

<footer>
<p><a rel="license" href="http://creativecommons.org/licenses/by/3.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by/3.0/88x31.png" /></a><br />This <span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/InteractiveResource" rel="dct:type">work</span> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">Creative Commons Attribution 3.0 Unported License</a>.</p>
</footer>

<script>
var	form = document.querySelector('form'),
	iframe = document.querySelector('iframe');

formHandler = function(e){
	e.preventDefault();
  	var msg = document.querySelector("#message").value;

	if( msg == ''){
		alert('Enter a message, please.');
	} else {
		iframe.contentWindow.postMessage(msg,'http://devfiles.myopera.com');
	}
}
form.addEventListener('submit', formHandler, false);


</script>
</body>
</html>
